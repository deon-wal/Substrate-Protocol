<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ALDERSYTH // ARCH_04: VECTOR_CRISIS</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link href="https://fonts.googleapis.com/css2?family=Space+Mono:ital,wght@0,400;0,700;1,400&display=swap" rel="stylesheet">
    <style>
        :root {
            /* THEME: LOG IV (Deep Violet / Crimson / Void) */
            --bg: #010003;
            --panel: rgba(10, 5, 16, 0.85);
            --border: rgba(139, 92, 246, 0.2);
            
            --violet: #8b5cf6;
            --crimson: #ef4444; 
            --void-text: #a78bfa;
            
            --scanline: rgba(0,0,0,0.5);
        }

        /* --- GLOBAL --- */
        body {
            background-color: var(--bg);
            color: var(--void-text);
            font-family: 'Space Mono', monospace;
            margin: 0;
            overflow: hidden; /* No scroll, full app feel */
            height: 100vh;
            font-size: 13px;
            display: flex; flex-direction: column;
        }

        /* --- BACKGROUND FX --- */
        #starfield { position: fixed; inset: 0; z-index: -1; pointer-events: none; }
        
        body::after {
            content: ""; position: fixed; inset: 0; pointer-events: none; z-index: 999;
            background: linear-gradient(rgba(18,16,16,0) 50%, rgba(0,0,0,0.25) 50%);
            background-size: 100% 4px;
        }

        /* --- HEADER --- */
        header {
            height: 60px;
            background: rgba(2, 0, 5, 0.95);
            border-bottom: 1px solid var(--border);
            display: flex; justify-content: space-between; align-items: center;
            padding: 0 30px;
            z-index: 10;
        }
        .logo { color: var(--violet); font-weight: 700; letter-spacing: 2px; text-shadow: 0 0 10px var(--violet); }
        .nav a { color: #555; text-decoration: none; margin-left: 20px; transition: 0.3s; }
        .nav a:hover { color: #fff; text-shadow: 0 0 5px #fff; }
        .nav a.active { color: var(--violet); border-bottom: 1px solid var(--violet); }
        
        .alert-box {
            border: 1px solid var(--crimson); color: var(--crimson); 
            padding: 5px 10px; font-size: 0.7rem; animation: pulse-red 2s infinite;
        }

        /* --- MAIN GRID --- */
        .viewport {
            flex: 1;
            display: grid;
            grid-template-columns: 300px 1fr 300px;
            gap: 20px;
            padding: 20px;
            overflow: hidden;
        }

        /* --- SIDE PANELS --- */
        .panel {
            background: var(--panel);
            border: 1px solid var(--border);
            padding: 20px;
            display: flex; flex-direction: column; gap: 15px;
            backdrop-filter: blur(5px);
        }
        .panel h3 { margin: 0; color: #fff; font-size: 0.8rem; border-bottom: 1px solid #333; padding-bottom: 8px; }

        .data-row { display: flex; justify-content: space-between; font-size: 0.75rem; color: #888; }
        .val { color: #fff; font-family: monospace; }
        .crimson { color: var(--crimson); text-shadow: 0 0 5px var(--crimson); }
        
        /* --- CENTER: THE LENS (3D SCENE) --- */
        .lens-container {
            position: relative;
            border: 1px solid var(--border);
            background: radial-gradient(circle at center, #1a1033 0%, #000 70%);
            overflow: hidden;
            display: flex; align-items: center; justify-content: center;
            perspective: 1000px;
        }
        
        /* THE TESSERACT (Cube inside Cube) */
        .scene {
            width: 200px; height: 200px;
            transform-style: preserve-3d;
            /* Animation controlled by JS for interaction */
        }
        
        .cube {
            position: absolute; width: 100%; height: 100%;
            transform-style: preserve-3d;
            animation: rotate 20s infinite linear;
        }
        
        .face {
            position: absolute; width: 200px; height: 200px;
            border: 1px solid var(--violet);
            background: rgba(139, 92, 246, 0.05);
            box-shadow: 0 0 15px rgba(139, 92, 246, 0.1);
            backface-visibility: visible;
        }
        
        /* Cube Face Transforms */
        .f1 { transform: rotateY(0deg) translateZ(100px); }
        .f2 { transform: rotateY(90deg) translateZ(100px); }
        .f3 { transform: rotateY(180deg) translateZ(100px); }
        .f4 { transform: rotateY(-90deg) translateZ(100px); }
        .f5 { transform: rotateX(90deg) translateZ(100px); }
        .f6 { transform: rotateX(-90deg) translateZ(100px); }

        /* Inner Core (The Anomaly) */
        .core {
            position: absolute; top: 50%; left: 50%;
            width: 60px; height: 60px;
            background: #000;
            border: 2px solid var(--crimson);
            transform: translate(-50%, -50%);
            box-shadow: 0 0 30px var(--crimson);
            animation: pulse-core 0.5s infinite alternate;
        }

        /* --- CONTROLS --- */
        .control-deck {
            position: absolute; bottom: 20px; left: 50%; transform: translateX(-50%);
            background: rgba(0,0,0,0.8); border: 1px solid #333; padding: 15px;
            display: flex; gap: 20px; align-items: center; width: 80%;
        }
        input[type=range] { flex: 1; accent-color: var(--violet); cursor: pointer; }
        
        /* --- LOGS --- */
        .log-feed {
            flex: 1; overflow-y: auto; font-size: 0.7rem; color: #666;
            border-top: 1px solid #333; margin-top: 10px; padding-top: 10px;
            font-family: 'Courier New', monospace;
        }
        .entry { margin-bottom: 12px; border-left: 2px solid #333; padding-left: 8px; }
        .ts { color: var(--violet); font-size: 0.65rem; display: block; margin-bottom: 2px; }

        /* --- ANIMATIONS --- */
        @keyframes rotate { 
            0% { transform: rotateX(0deg) rotateY(0deg); } 
            100% { transform: rotateX(360deg) rotateY(360deg); } 
        }
        @keyframes pulse-red { 0% { opacity: 0.6; } 50% { opacity: 1; } 100% { opacity: 0.6; } }
        @keyframes pulse-core { from { width: 60px; height: 60px; opacity: 0.8; } to { width: 70px; height: 70px; opacity: 1; } }

        /* Glitch Class applied via JS */
        .glitch-active { animation: glitch-skew 0.2s infinite; }
        @keyframes glitch-skew {
            0% { transform: skew(0deg); filter: hue-rotate(0deg); }
            25% { transform: skew(10deg); filter: hue-rotate(90deg); }
            50% { transform: skew(-10deg); filter: hue-rotate(180deg); }
            75% { transform: skew(5deg); filter: hue-rotate(270deg); }
            100% { transform: skew(0deg); filter: hue-rotate(0deg); }
        }

        /* --- MOBILE --- */
        @media(max-width: 900px) {
            .viewport { grid-template-columns: 1fr; overflow-y: auto; }
            .lens-container { height: 400px; }
        }

    </style>
</head>
<body>

    <canvas id="starfield"></canvas>

    <header>
        <div class="logo">ALDERSYTH // OBSERVATORY</div>
        <nav class="nav">
            <a href="index.html">CORE</a>
            <a href="market.html">MARKET</a>
            <a href="residential.html">RESIDENTIAL</a>
            <a href="observatory.html" class="active">OBSERVATORY</a>
            <a href="backdoor.html" style="opacity:0.3;">_ROOT</a>
        </nav>
        <div class="alert-box">
            ⚠ SECTOR 4 COLLAPSE IMMINENT
        </div>
    </header>

    <div class="viewport">
        
        <aside class="panel">
            <h3>HIGGS_FIELD_TELEMETRY</h3>
            <div class="data-row"><span>VECTOR_A (X)</span><span class="val" id="vec-x">0.00</span></div>
            <div class="data-row"><span>VECTOR_B (Y)</span><span class="val" id="vec-y">0.00</span></div>
            <div class="data-row"><span>VECTOR_C (Z)</span><span class="val" id="vec-z">0.00</span></div>
            <div class="data-row"><span>ENTROPY</span><span class="val crimson" id="entropy-val">CRITICAL</span></div>
            
            <h3 style="margin-top:20px;">VOID_ATMOSPHERICS</h3>
            <div class="data-row"><span>TEMP</span><span class="val">-272.9°C</span></div>
            <div class="data-row"><span>PRESSURE</span><span class="val">0 Pa</span></div>
            <div class="data-row"><span>VISUAL</span><span class="val" style="color:var(--violet);">HAZE DETECTED</span></div>

            <div style="margin-top:auto; padding:15px; background:rgba(239, 68, 68, 0.1); border:1px solid var(--crimson); font-size:0.7rem; color:#fff;">
                <strong>URGENT:</strong> "Dimensional shearing" detected. The geometry of the city is folding inward like origami.
            </div>
        </aside>

        <main class="lens-container" id="lens-viewport">
            
            <div style="position:absolute; top:20px; left:20px; color:var(--violet); z-index:10; font-size:0.8rem; pointer-events:none;">
                TARGET: SINGULARITY_ANCHOR<br>
                DISTORTION: <span id="dist-val">0%</span>
            </div>

            <div class="scene">
                <div class="cube" id="tesseract">
                    <div class="face f1"></div>
                    <div class="face f2"></div>
                    <div class="face f3"></div>
                    <div class="face f4"></div>
                    <div class="face f5"></div>
                    <div class="face f6"></div>
                    <div class="core"></div>
                </div>
            </div>

            <div class="control-deck">
                <span style="font-size:0.7rem; color:#888;">LENS_SHEAR</span>
                <input type="range" min="0" max="100" value="0" id="warp-slider">
                <button style="background:var(--crimson); border:none; color:#fff; padding:8px 15px; font-family:inherit; cursor:pointer; font-weight:bold;" onclick="triggerReset()">RESET_ANCHOR</button>
            </div>
        </main>

        <aside class="panel">
            <h3>ANOMALY_LOGS // LIVE</h3>
            <div class="log-feed" id="log-feed">
                </div>
            
            <div style="border-top:1px solid #333; padding-top:10px;">
                <h3 style="border:none;">SURVEILLANCE_FEED</h3>
                <div style="background:#000; height:100px; border:1px solid #333; display:flex; align-items:center; justify-content:center; color:#333; font-size:0.7rem;">
                    [SIGNAL_LOST]
                </div>
                <div style="font-size:0.65rem; color:#555; margin-top:5px;">
                    LAST SEEN: Bio-mimetic Crow (Red Iris)
                </div>
            </div>
        </aside>

    </div>

    <script>
        // --- 1. STARFIELD BACKGROUND ---
        const canvas = document.getElementById('starfield');
        const ctx = canvas.getContext('2d');
        let width, height, stars = [];

        function initStars() {
            width = window.innerWidth;
            height = window.innerHeight;
            canvas.width = width;
            canvas.height = height;
            stars = [];
            for(let i=0; i<150; i++) {
                stars.push({
                    x: Math.random() * width,
                    y: Math.random() * height,
                    z: Math.random() * 2, // Speed/Depth
                    o: Math.random() // Opacity
                });
            }
        }

        function animateStars() {
            ctx.clearRect(0, 0, width, height);
            ctx.fillStyle = "#fff";
            
            stars.forEach(s => {
                s.x -= s.z * 0.2; // Move left (Drift)
                if(s.x < 0) s.x = width;
                
                ctx.globalAlpha = s.o;
                ctx.beginPath();
                ctx.arc(s.x, s.y, s.z * 0.8, 0, Math.PI*2);
                ctx.fill();
            });
            requestAnimationFrame(animateStars);
        }

        window.addEventListener('resize', initStars);
        initStars();
        animateStars();

        // --- 2. INTERACTIVE TESSERACT ---
        const slider = document.getElementById('warp-slider');
        const tesseract = document.getElementById('tesseract');
        const distVal = document.getElementById('dist-val');

        slider.addEventListener('input', (e) => {
            const val = e.target.value;
            // Apply CSS transforms based on slider
            // "Shearing" effect: skew and scale
            tesseract.style.transform = `rotateX(${val * 2}deg) skew(${val/2}deg) scale(${1 + val/100})`;
            distVal.innerText = val + "%";
            
            // Random glitch text color if high distortion
            if(val > 80) distVal.style.color = "#ef4444";
            else distVal.style.color = "#8b5cf6";
        });

        // --- 3. RESET BUTTON (GLITCH FX) ---
        function triggerReset() {
            const lens = document.getElementById('lens-viewport');
            // Add glitch class
            lens.classList.add('glitch-active');
            
            // Log entry
            addLog("MANUAL_RESET_ATTEMPTED...", "var(--crimson)");
            
            setTimeout(() => {
                lens.classList.remove('glitch-active');
                slider.value = 0;
                tesseract.style.transform = "none";
                distVal.innerText = "0%";
                addLog("ANCHOR STABILIZED. TEMPORARILY.", "var(--violet)");
            }, 800);
        }

        // --- 4. LIVE TELEMETRY SIMULATION ---
        function updateVectors() {
            document.getElementById('vec-x').innerText = (Math.random()).toFixed(4);
            document.getElementById('vec-y').innerText = (Math.random()).toFixed(4);
            document.getElementById('vec-z').innerText = (Math.random()).toFixed(4);
            
            // Random Entropy Spikes
            if(Math.random() > 0.9) {
                document.getElementById('entropy-val').innerText = "ERROR_NULL";
            } else {
                document.getElementById('entropy-val').innerText = "CRITICAL";
            }
        }
        setInterval(updateVectors, 200);

        // --- 5. NARRATIVE LOGS ---
        const logs = [
            { msg: "Sensor 4 lost contact with surface.", type: "normal" },
            { msg: "Visual confirmation: The walkway is folding.", type: "crimson" },
            { msg: "Kael reported nausea. Metric Shift syndrome.", type: "normal" },
            { msg: "The Crow is watching the lens.", type: "violet" },
            { msg: "Unknown signal detected from The Substrate.", type: "violet" },
            { msg: "Gravity fluctuations in Sector 7.", type: "crimson" }
        ];

        function addLog(msg, colorOverride) {
            const feed = document.getElementById('log-feed');
            const time = new Date().toLocaleTimeString();
            const div = document.createElement('div');
            div.className = 'entry';
            
            // Pick random log if not provided
            if(!msg) {
                const r = logs[Math.floor(Math.random() * logs.length)];
                msg = r.msg;
                // Map types to colors
                if(r.type === 'crimson') colorOverride = 'var(--crimson)';
                else if(r.type === 'violet') colorOverride = 'var(--violet)';
                else colorOverride = '#888';
            }

            div.innerHTML = `<span class="ts">[${time}]</span> <span style="color:${colorOverride}">${msg}</span>`;
            feed.prepend(div);
            
            if(feed.children.length > 20) feed.lastChild.remove();
        }

        // Add random log every 3-6 seconds
        setInterval(() => addLog(), 4000);
        addLog("SYSTEM_BOOT_COMPLETE. OBSERVATORY ONLINE.", "#fff");

    </script>
</body>
</html>
