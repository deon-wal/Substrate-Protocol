<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ALDERSYTH // ULTIMATE_OBSERVATORY</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link href="https://fonts.googleapis.com/css2?family=Share+Tech+Mono&display=swap" rel="stylesheet">
    <style>
        :root {
            --bg: #020205;
            --panel: rgba(10, 10, 15, 0.98);
            --border: rgba(139, 92, 246, 0.4);
            --violet: #8b5cf6;
            --crimson: #ef4444;
            --cyan: #06b6d4;
            --gold: #d4af37;
        }

        /* FUTURISTIC SCROLLBAR */
        ::-webkit-scrollbar { width: 4px; }
        ::-webkit-scrollbar-track { background: var(--bg); }
        ::-webkit-scrollbar-thumb { background: var(--violet); box-shadow: 0 0 10px var(--violet); }

        body {
            background-color: var(--bg); color: var(--violet);
            font-family: 'Share Tech Mono', monospace;
            margin: 0; height: 100vh; overflow: hidden;
            display: flex; flex-direction: column; perspective: 1000px;
        }

        /* FX OVERLAYS */
        #fx-overlay {
            position: fixed; inset: 0; pointer-events: none; z-index: 100;
            background: linear-gradient(rgba(18,16,16,0) 50%, rgba(0,0,0,0.1) 50%);
            background-size: 100% 4px; opacity: 0.3;
        }
        #starfield { position: fixed; inset: 0; z-index: -1; }

        header {
            height: 60px; background: rgba(2, 2, 5, 0.98); border-bottom: 1px solid var(--border);
            display: flex; justify-content: space-between; align-items: center;
            padding: 0 30px; z-index: 110;
        }
        .logo { color: var(--violet); letter-spacing: 4px; font-weight: bold; text-shadow: 0 0 10px var(--violet); }
        .nav a { color: #444; text-decoration: none; margin-left: 20px; transition: 0.3s; font-size: 0.8rem; }
        .nav a:hover { color: #fff; text-shadow: 0 0 8px #fff; }
        .nav a.active { color: var(--violet); border-bottom: 1px solid var(--violet); }

        /* BOOT INTERACTION */
        #start-overlay {
            position: fixed; inset: 0; background: #000; z-index: 999;
            display: flex; align-items: center; justify-content: center; flex-direction: column; transition: 1s;
        }
        .start-btn {
            background: transparent; border: 1px solid var(--violet); color: var(--violet);
            padding: 20px 50px; font-family: inherit; font-size: 1.2rem; cursor: pointer;
            letter-spacing: 5px; transition: 0.3s;
        }
        .start-btn:hover { background: var(--violet); color: #000; box-shadow: 0 0 40px var(--violet); }

        /* HUD VIEWPORT */
        .viewport {
            flex: 1; display: grid; grid-template-columns: 320px 1fr 320px;
            gap: 20px; padding: 20px; transform-style: preserve-3d; transition: transform 0.1s ease-out;
        }

        .panel {
            background: var(--panel); border: 1px solid var(--border); padding: 25px;
            display: flex; flex-direction: column; backdrop-filter: blur(10px);
            box-shadow: inset 0 0 20px rgba(139, 92, 246, 0.1);
        }

        .scope-container {
            position: relative; background: radial-gradient(circle at center, #0a051a 0%, #000 100%);
            border: 1px solid var(--border); overflow: hidden; display: flex; flex-direction: column;
        }
        #signal-canvas { width: 100%; height: 100%; filter: contrast(1.5); }
        
        .scope-hud { position: absolute; top: 30px; left: 30px; pointer-events: none; }
        .status-txt { font-size: 2.5rem; font-weight: 900; margin-top: 10px; letter-spacing: -2px; }

        .control-deck {
            background: rgba(0,0,0,0.9); border-top: 1px solid var(--border);
            padding: 25px; display: flex; gap: 40px; justify-content: center;
        }
        .slider-group { text-align: left; flex: 1; max-width: 250px; }
        .label { font-size: 0.65rem; color: var(--gold); display: block; margin-bottom: 8px; letter-spacing: 2px; }
        input[type=range] { width: 100%; accent-color: var(--violet); cursor: crosshair; }

        #decode-screen {
            font-size: 0.75rem; color: #888; line-height: 1.8; white-space: pre-wrap;
            transition: 0.5s; font-family: monospace;
        }
        .locked { opacity: 0.3; filter: blur(2px); }
        .unlocked { opacity: 1; filter: none; color: var(--cyan); text-shadow: 0 0 10px var(--cyan); }

        .vu-meter { height: 2px; background: #111; margin-top: 8px; overflow: hidden; }
        .vu-fill { height: 100%; width: 0%; background: var(--violet); box-shadow: 0 0 10px var(--violet); }
    </style>
</head>
<body>

    <div id="fx-overlay"></div>
    <canvas id="starfield"></canvas>

    <div id="start-overlay">
        <div style="margin-bottom: 30px; letter-spacing: 10px; color: var(--violet);">OBSERVATORY // LENS_INIT</div>
        <button class="start-btn" onclick="initSystem()">CONNECT_TO_VOID</button>
    </div>

    <header>
        <div class="logo">ALDERSYTH // OBSERVATORY</div>
        <nav class="nav">
            <a href="index.html">CORE</a>
            <a href="market.html">MARKET</a>
            <a href="residential.html">RESIDENTIAL</a>
            <a href="observatory.html" class="active">OBSERVATORY</a>
            <a href="sync.html">SYNC</a>
            <a href="login.html" style="color:var(--gold)">_ROOT</a>
        </nav>
    </header>

    <div class="viewport" id="hud">
        <aside class="panel">
            <div style="color:var(--gold); font-size: 0.8rem; border-bottom:1px solid #333; padding-bottom:10px; margin-bottom:20px; letter-spacing: 3px;">SIGNAL_ANALYSIS</div>
            <div style="margin-bottom: 30px;">
                <span class="label">GAIN_INPUT</span>
                <div class="vu-meter"><div class="vu-fill" id="vu-sig"></div></div>
            </div>
            <div style="margin-bottom: 30px;">
                <span class="label">COSMIC_NOISE</span>
                <div class="vu-meter"><div class="vu-fill" id="vu-bg" style="background:var(--crimson);"></div></div>
            </div>
            <div style="margin-top:auto; font-size:0.65rem; color:#444; line-height: 2;">
                <span style="color:var(--teal)">> SCANNING SECTOR_NULL...</span><br>
                > FREQ_SHIFT: <span id="freq-read">000.00</span><br>
                > AUDIO: <span id="audio-stat">OFFLINE</span>
            </div>
        </aside>

        <main class="scope-container">
            <canvas id="signal-canvas"></canvas>
            <div class="scope-hud">
                <div style="color:var(--gold); font-size:0.7rem; letter-spacing: 3px;">TRACKING: UNKNOWN_VECTOR</div>
                <div id="lock-status" class="status-txt" style="color:var(--crimson)">SEARCHING...</div>
            </div>

            <div class="control-deck">
                <div class="slider-group">
                    <span class="label">PITCH_RESONANCE</span>
                    <input type="range" min="10" max="100" value="20" id="freq">
                </div>
                <div class="slider-group">
                    <span class="label">THERMODYNAMIC_GAIN</span>
                    <input type="range" min="1" max="100" value="10" id="amp">
                </div>
                <div class="slider-group">
                    <span class="label">PHASE_DRIFT</span>
                    <input type="range" min="1" max="100" value="80" id="phase">
                </div>
            </div>
        </main>

        <aside class="panel">
            <div style="color:var(--gold); font-size: 0.8rem; border-bottom:1px solid #333; padding-bottom:10px; margin-bottom:20px; letter-spacing: 3px;">ENCRYPTED_STREAM</div>
            <div id="decode-screen" class="locked">
[NO SIGNAL DATA]
------------------
ALIGN WAVEFORMS
TO RESOLVE CORE
MEMORIES.
            </div>
        </aside>
    </div>

    <script>
        const cvs = document.getElementById('signal-canvas');
        const ctx = cvs.getContext('2d');
        const starCvs = document.getElementById('starfield');
        const starCtx = starCvs.getContext('2d');
        const hud = document.getElementById('hud');

        let audioCtx, osc, gainNode, panner;
        let isRunning = false;
        let time = 0;
        let lockTimer = 0;

        const target = { freq: 42, amp: 55, phase: 15 };

        function resize() {
            cvs.width = cvs.parentElement.offsetWidth;
            cvs.height = cvs.parentElement.offsetHeight;
            starCvs.width = window.innerWidth;
            starCvs.height = window.innerHeight;
        }
        window.addEventListener('resize', resize);
        resize();

        // MOUSE PARALLAX
        document.addEventListener('mousemove', (e) => {
            const x = (window.innerWidth / 2 - e.pageX) / 50;
            const y = (window.innerHeight / 2 - e.pageY) / 50;
            hud.style.transform = `rotateY(${x}deg) rotateX(${-y}deg)`;
        });

        function initSystem() {
            document.getElementById('start-overlay').style.opacity = '0';
            setTimeout(() => document.getElementById('start-overlay').style.display = 'none', 1000);
            
            // AUDIO START
            audioCtx = new (window.AudioContext || window.webkitAudioContext)();
            osc = audioCtx.createOscillator();
            gainNode = audioCtx.createGain();
            panner = audioCtx.createStereoPanner();

            osc.type = 'sawtooth';
            osc.frequency.value = 55;
            gainNode.gain.value = 0.05;

            osc.connect(panner); panner.connect(gainNode); gainNode.connect(audioCtx.destination);
            osc.start();

            document.getElementById('audio-stat').innerText = "ONLINE";
            document.getElementById('audio-stat').style.color = "var(--teal)";

            isRunning = true;
            loop();
        }

        let stars = Array(150).fill().map(() => ({
            x: Math.random() * window.innerWidth,
            y: Math.random() * window.innerHeight,
            z: Math.random() * 2,
            o: Math.random()
        }));

        function drawStars(shake) {
            starCtx.clearRect(0,0,starCvs.width, starCvs.height);
            stars.forEach(s => {
                s.x -= 0.1; if(s.x < 0) s.x = starCvs.width;
                let dx = (Math.random() - 0.5) * shake;
                let dy = (Math.random() - 0.5) * shake;
                starCtx.fillStyle = `rgba(255,255,255,${s.o})`;
                starCtx.beginPath();
                starCtx.arc(s.x + dx, s.y + dy, s.z, 0, Math.PI*2);
                starCtx.fill();
            });
        }

        function loop() {
            if(!isRunning) return;
            requestAnimationFrame(loop);
            time += 0.15;
            ctx.clearRect(0,0,cvs.width, cvs.height);

            const f = parseInt(document.getElementById('freq').value);
            const a = parseInt(document.getElementById('amp').value);
            const p = parseInt(document.getElementById('phase').value);

            // UPDATING AUDIO DYNAMICALLY
            osc.frequency.setTargetAtTime(40 + (f * 2), audioCtx.currentTime, 0.1);
            gainNode.gain.setTargetAtTime(a * 0.002, audioCtx.currentTime, 0.1);
            panner.pan.setTargetAtTime((p - 50) / 50, audioCtx.currentTime, 0.1);

            document.getElementById('vu-sig').style.width = a + "%";
            document.getElementById('vu-bg').style.width = (10 + Math.random() * 15) + "%";
            document.getElementById('freq-read').innerText = (f * 12.5).toFixed(2);

            drawWave(target.freq, target.amp, target.phase, "rgba(239, 68, 68, 0.2)", 1, true);
            drawWave(f, a, p, "#8b5cf6", 3, false);

            const match = Math.abs(f - target.freq) < 4 && Math.abs(a - target.amp) < 8 && Math.abs(p - target.phase) < 8;
            if(match) lockTimer++; else lockTimer = Math.max(0, lockTimer - 1.5);

            updateUI(lockTimer);
            drawStars(a * 0.2); 
        }

        function drawWave(f, a, p, color, width, isGhost) {
            ctx.beginPath(); ctx.strokeStyle = color; ctx.lineWidth = width;
            let centerY = cvs.height / 2;
            for(let x=0; x<cvs.width; x++) {
                let shift = isGhost ? Math.sin(time*0.5) * 20 : 0;
                let y = centerY + shift + Math.sin(x * f * 0.003 + p * 0.2 + time) * (a * 2.5);
                if(x===0) ctx.moveTo(x,y); else ctx.lineTo(x,y);
            }
            ctx.stroke();
        }

        function updateUI(timer) {
            const status = document.getElementById('lock-status');
            const screen = document.getElementById('decode-screen');
            if(timer > 60) {
                status.innerText = "VECTOR_SYNCED"; status.style.color = "var(--cyan)";
                screen.className = "unlocked";
                screen.innerHTML = `[ORIGIN_RECOVERED]\n------------------\n"The Spire is a cage.\nThe Market a distraction.\n\nThey are mining MEMORIES.\nBuilding a bridge out of\nour discarded lives."\n------------------\nCOORD: SECTOR_NULL`;
            } else {
                status.innerText = "SEARCHING..."; status.style.color = "var(--crimson)";
                screen.className = "locked";
                screen.innerHTML = "[ENCRYPTED DATA]\nALIGN WAVEFORMS\nTO RESOLVE...";
            }
        }
    </script>
</body>
</html>
