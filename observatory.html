<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ALDERSYTH // OBSERVATORY_V2</title>
    <link href="https://fonts.googleapis.com/css2?family=Share+Tech+Mono&display=swap" rel="stylesheet">
    <style>
        :root {
            --bg: #0a0a0c;
            --panel: #0d0d0f;
            --border: #1a1a1f;
            --violet: #8b5cf6;
            --crimson: #ef4444;
            --cyan: #06b6d4;
            --gold: #d4af37;
        }

        /* CLEAN SCROLLBAR */
        ::-webkit-scrollbar { width: 4px; }
        ::-webkit-scrollbar-track { background: var(--bg); }
        ::-webkit-scrollbar-thumb { background: #222; }

        body {
            background-color: var(--bg); color: var(--violet);
            font-family: 'Share Tech Mono', monospace; margin: 0;
            height: 100vh; overflow: hidden; display: flex; flex-direction: column;
        }

        header {
            height: 50px; background: #000; border-bottom: 1px solid var(--border);
            display: flex; justify-content: space-between; align-items: center; padding: 0 30px;
        }
        .nav a { color: #444; text-decoration: none; margin-left: 15px; font-size: 0.75rem; letter-spacing: 1px; transition: 0.2s; }
        .nav a:hover, .nav a.active { color: var(--violet); }

        /* HUD LAYOUT */
        .viewport {
            flex: 1; display: grid; grid-template-columns: 280px 1fr 300px;
            background: var(--border); gap: 1px;
        }
        .panel { background: var(--panel); padding: 20px; display: flex; flex-direction: column; }

        /* --- TRIPLE LENS SYSTEM --- */
        .lens-array {
            display: grid; grid-template-rows: repeat(3, 1fr);
            gap: 1px; background: var(--border); overflow: hidden;
        }
        .lens-cell {
            position: relative; background: #000; display: flex; align-items: center; justify-content: center;
        }
        canvas { width: 100%; height: 100%; }
        
        .lens-label {
            position: absolute; top: 10px; left: 15px; font-size: 0.6rem; color: #333; letter-spacing: 2px;
        }

        /* ASSET: THE ENTITY (Small, Clean Tracking) */
        #entity-layer {
            position: absolute; width: 100px; height: 100px;
            background: url('image_3c0f45.jpg') no-repeat center;
            background-size: contain; opacity: 0; filter: blur(5px) hue-rotate(90deg);
            transition: opacity 0.5s; pointer-events: none;
        }

        /* DATA UI */
        .label { font-size: 0.6rem; color: var(--gold); display: block; margin-bottom: 5px; opacity: 0.7; }
        .data-readout { font-size: 0.8rem; color: #fff; margin-bottom: 15px; font-family: monospace; }
        
        /* ASSET: MEMORY BOX (log4.jpg) */
        #memory-visual {
            width: 100%; height: 180px; border: 1px solid #222;
            background: url('log4.jpg') no-repeat center; background-size: cover;
            filter: grayscale(1) brightness(0.2) blur(5px); transition: 1s ease;
        }
        #memory-visual.decrypted { filter: grayscale(0) brightness(0.8) blur(0px); border-color: var(--cyan); }

        /* CONTROLS (CLEAN BARS) */
        .control-deck {
            background: #000; border-top: 1px solid var(--border);
            padding: 20px 40px; display: flex; gap: 40px; justify-content: center;
        }
        .slider-group { flex: 1; max-width: 200px; }
        input[type=range] { width: 100%; accent-color: var(--violet); background: #111; height: 2px; appearance: none; outline: none; }
    </style>
</head>
<body>

    <header>
        <div style="font-weight:bold; letter-spacing:2px; font-size: 0.9rem;">ALDERSYTH_OS // OBSERVATORY</div>
        <nav class="nav">
            <a href="index.html">HUB</a>
            <a href="market.html">MARKET</a>
            <a href="spire.html">SPIRE</a>
            <a href="observatory.html" class="active">OBSERVATORY</a>
            <a href="login.html" style="color:var(--crimson)">ROOT_BYPASS</a>
        </nav>
    </header>

    <div class="viewport">
        <aside class="panel">
            <span class="label">SIGNAL_STRENGTH</span>
            <div class="data-readout" id="read-amp">0.00%</div>
            
            <span class="label">PITCH_RESONANCE</span>
            <div class="data-readout" id="read-freq">000.0 Hz</div>

            <span class="label">STRESS_GEOMETRY</span>
            <div style="flex:1; border: 1px solid #1a1a1f; background: url('pin3.jpg.png'); opacity:0.1;"></div>
        </aside>

        <main class="lens-array">
            <div class="lens-cell">
                <span class="lens-label">LENS_01 // FREQUENCY</span>
                <canvas id="cvs-1"></canvas>
                <div id="entity-layer"></div>
            </div>
            <div class="lens-cell">
                <span class="lens-label">LENS_02 // AMPLITUDE</span>
                <canvas id="cvs-2"></canvas>
            </div>
            <div class="lens-cell">
                <span class="lens-label">LENS_03 // PHASE</span>
                <canvas id="cvs-3"></canvas>
            </div>
        </main>

        <aside class="panel">
            <span class="label">VISUAL_FRAGMENT_04</span>
            <div id="memory-visual" style="margin-bottom: 15px;"></div>
            
            <span class="label">DECRYPTED_DATA</span>
            <div id="log-txt" style="font-size: 0.75rem; color: #444; line-height: 1.6;">
                [ENCRYPTED_SIGNAL]
                ---
                ALIGN VECTORS TO RESOLVE.
            </div>
        </aside>
    </div>

    <div class="control-deck">
        <div class="slider-group">
            <span class="label">FREQ</span>
            <input type="range" id="freq" min="10" max="100" value="20">
        </div>
        <div class="slider-group">
            <span class="label">AMP</span>
            <input type="range" id="amp" min="1" max="100" value="10">
        </div>
        <div class="slider-group">
            <span class="label">PHASE</span>
            <input type="range" id="phase" min="1" max="100" value="50">
        </div>
    </div>

    <script>
        const canals = [
            {cvs: document.getElementById('cvs-1'), ctx: document.getElementById('cvs-1').getContext('2d')},
            {cvs: document.getElementById('cvs-2'), ctx: document.getElementById('cvs-2').getContext('2d')},
            {cvs: document.getElementById('cvs-3'), ctx: document.getElementById('cvs-3').getContext('2d')}
        ];
        
        let time = 0;
        const target = { f: 42, a: 60, p: 25 };

        function resize() {
            canals.forEach(c => {
                c.cvs.width = c.cvs.parentElement.offsetWidth;
                c.cvs.height = c.cvs.parentElement.offsetHeight;
            });
        }
        window.addEventListener('resize', resize);
        resize();

        function loop() {
            requestAnimationFrame(loop);
            time += 0.15;
            
            const f = parseInt(document.getElementById('freq').value);
            const a = parseInt(document.getElementById('amp').value);
            const p = parseInt(document.getElementById('phase').value);

            document.getElementById('read-amp').innerText = a + ".00%";
            document.getElementById('read-freq').innerText = (f * 8).toFixed(1) + " Hz";

            canals.forEach((c, idx) => {
                c.ctx.clearRect(0,0,c.cvs.width, c.cvs.height);
                // Draw clean grid lines
                c.ctx.strokeStyle = "#080808";
                for(let i=0; i<c.cvs.width; i+=40) { c.ctx.beginPath(); c.ctx.moveTo(i,0); c.ctx.lineTo(i,c.cvs.height); c.ctx.stroke(); }
                
                // Draw logic-specific waves
                drawWave(c.ctx, c.cvs, target.f, target.a, target.p, "rgba(255,0,0,0.05)", 1);
                drawWave(c.ctx, c.cvs, f, a, p, "#8b5cf6", 2);
            });

            // Match Logic
            const match = Math.abs(f - target.f) < 4 && Math.abs(a - target.a) < 8 && Math.abs(p - target.p) < 8;
            const log = document.getElementById('log-txt');
            const visual = document.getElementById('memory-visual');
            const entity = document.getElementById('entity-layer');

            if(match) {
                entity.style.opacity = "0.6";
                visual.classList.add('decrypted');
                log.style.color = "var(--cyan)";
                log.innerHTML = `[ORIGIN_RECOVERED]<br>---<br>"They are mining MEMORIES to build a bridge out of our discarded lives."`;
            } else {
                entity.style.opacity = "0";
                visual.classList.remove('decrypted');
                log.style.color = "#444";
                log.innerText = "[ENCRYPTED_SIGNAL] --- ALIGN VECTORS TO RESOLVE.";
            }
        }

        function drawWave(ctx, cvs, f, a, p, color, width) {
            ctx.beginPath(); ctx.strokeStyle = color; ctx.lineWidth = width;
            let cy = cvs.height / 2;
            for(let x=0; x<cvs.width; x++) {
                let y = cy + Math.sin(x * f * 0.004 + p * 0.1 + time) * (a * 1.2);
                if(x===0) ctx.moveTo(x,y); else ctx.lineTo(x,y);
            }
            ctx.stroke();
        }

        loop();
    </script>
</body>
</html>
